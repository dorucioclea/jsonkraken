buildscript {
    ext.dokka_version = "0.10.1"
    ext.kotlin_version = "1.3.61"
    ext.coveralls_version = "2.9.0"
    ext.pitest_version = "1.4.6"
    ext.junit_version = "4.12"
}

plugins {
    id "org.jetbrains.dokka" version "$dokka_version"
    id "org.jetbrains.kotlin.jvm" version "$kotlin_version"
    id "info.solidsoft.pitest" version "$pitest_version"
    id "com.github.kt3k.coveralls" version "$coveralls_version"
}

//apply plugin: "maven-publish"
//apply plugin: "signing"

repositories {
    jcenter()
    mavenCentral()
}

group 'net.jemzart.jsonkraken'
version '2.0.0-SNAPSHOT'

dependencies {
    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlin_version"
    implementation "org.jetbrains.kotlin:kotlin-reflect:$kotlin_version"
    testImplementation "junit:junit:$junit_version"
}

compileKotlin {
    kotlinOptions.jvmTarget = "1.8"
}
compileTestKotlin {
    kotlinOptions.jvmTarget = "1.8"
}

coveralls {
    sourceDirs += ['src/main/kotlin']
}

pitest {
    targetClasses = ['net.jemzart.jsonkraken.*']
    timestampedReports = false
    outputFormats = ['XML', 'HTML']
}

dokka {
    outputFormat = 'html'
    outputDirectory = "$buildDir/javadoc"
    configuration {
        sourceLink {
            path = "src/main/kotlin"
            url = "https://github.com/zogar1993/jsonkraken"
            lineSuffix = "#L"
        }
    }
}

task sourceJar(type: Jar) {
    classifier = 'sources'
    from sourceSets.main.allSource
}

task dokkaJavadoc(type: org.jetbrains.dokka.gradle.DokkaTask) {
    outputFormat = 'javadoc'
    outputDirectory = "$buildDir/javadoc"
}

task javadocJar(type: Jar, dependsOn: dokkaJavadoc) {
    classifier = 'javadoc'
    from javadoc.destinationDir
}

artifacts {
    archives jar
    archives sourceJar
    archives javadocJar
}